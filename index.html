<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>lua-bindings: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">lua-bindings
   </div>
   <div id="projectbrief">C++ bindings for Lua 5.3</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">lua-bindings Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>These are bindings intended to easily embed <a class="el" href="namespaceLua.html">Lua</a> into a C++11 project.</p>
<p>Everything is done by including a single header file, <code>&lt;<a class="el" href="LuaState_8hh.html">lua-bindings/LuaState.hh</a>&gt;</code>, then compiling against the static library created by the included SConstruct. The static library can also be built from the included SConscript, as part of a larger build.</p>
<h2>Loading files </h2>
<p>To load a file, use LuaState::LoadFile() </p>
<pre class="fragment">Lua::LuaState L;
L.LoadFile("some_file.lua");
</pre><p>Alternatively, use LuaState::LoadString() to directly load a string containing code. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("print('hi')");
</pre><h2>Loading Libraries </h2>
<p>There are two functions available, <code>LuaState::LoadLibs</code> and <code>LuaState::LoadSafeLibs</code>. These each will load standard libraries available in <a class="el" href="namespaceLua.html">Lua</a>. However, <code>LuaState::LoadSafeLibs</code> will only load library functions that are safe for an untrusted user to have access to. The list of functions available in safe mode is as follows.</p>
<ul>
<li><code>ipairs</code></li>
<li><code>pairs</code></li>
<li><code>print</code></li>
<li><code>next</code></li>
<li><code>pcall</code></li>
<li><code>tonumber</code></li>
<li><code>tostring</code></li>
<li><code>type</code></li>
<li><code>unpack</code></li>
<li><code>coroutine.create</code></li>
<li><code>coroutine.resume</code></li>
<li><code>coroutine.running</code></li>
<li><code>coroutine.status</code></li>
<li><code>coroutine.wrap</code></li>
<li><code>string.byte</code></li>
<li><code>string.char</code></li>
<li><code>string.find</code></li>
<li><code>string.format</code></li>
<li><code>string.gmatch</code></li>
<li><code>string.gsub</code></li>
<li><code>string.len</code></li>
<li><code>string.lower</code></li>
<li><code>string.match</code></li>
<li><code>string.rep</code></li>
<li><code>string.reverse</code></li>
<li><code>string.sub</code></li>
<li><code>string.upper</code></li>
<li><code>table.insert</code></li>
<li><code>table.maxn</code></li>
<li><code>table.remove</code></li>
<li><code>table.sort</code></li>
<li><code>math.abs</code></li>
<li><code>math.acos</code></li>
<li><code>math.asin</code></li>
<li><code>math.atan</code></li>
<li><code>math.atan2</code></li>
<li><code>math.ceil</code></li>
<li><code>math.cos</code></li>
<li><code>math.cosh</code></li>
<li><code>math.deg</code></li>
<li><code>math.exp</code></li>
<li><code>math.floor</code></li>
<li><code>math.fmod</code></li>
<li><code>math.frexp</code></li>
<li><code>math.huge</code></li>
<li><code>math.ldexp</code></li>
<li><code>math.log</code></li>
<li><code>math.log10</code></li>
<li><code>math.max</code></li>
<li><code>math.min</code></li>
<li><code>math.modf</code></li>
<li><code>math.pi</code></li>
<li><code>math.pow</code></li>
<li><code>math.rad</code></li>
<li><code>math.random</code></li>
<li><code>math.sin</code></li>
<li><code>math.sinh</code></li>
<li><code>math.sqrt</code></li>
<li><code>math.tan</code></li>
<li><code>math.tanh</code></li>
<li><code>os.clock</code></li>
<li><code>os.difftime</code></li>
<li><code>os.time</code></li>
</ul>
<h2>Getting/Setting Global Variables </h2>
<p>The C++ code can read/write global variables to be available in <a class="el" href="namespaceLua.html">Lua</a>. When setting a variable, the type is automatically determined from the parameter. </p>
<pre class="fragment">Lua::LuaState L;
L.SetGlobal("x", 5);
</pre><p>When reading a variable, the type must be specified. </p>
<pre class="fragment">int x = L.CastGlobal&lt;int&gt;("x");
</pre><h2>Functions </h2>
<p>To call <a class="el" href="namespaceLua.html">Lua</a> functions from C++, use the LuaState::Call() method. Note the templated parameter which gives the return type of the function. If the <a class="el" href="namespaceLua.html">Lua</a> function returns a value that cannot be converted to the requested type, a <code>LuaInvalidStackContents</code> will be thrown. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("function add_one(x) return x+1 end");
int output = L.Call&lt;int&gt;(42);
</pre><p><a class="el" href="namespaceLua.html">Lua</a> functions can return multiple values. If the return value is requested as a std::tuple&lt;&gt;, then multiple values will be read. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("function multiple_returns() return 5, 'hello' end");
std::tuple&lt;int, std::string&gt; output =
  L.Call&lt;std::tuple&lt;int, std::string&gt; &gt;("multiple_returns");
</pre><p>C++ functions can be registered, so that they can be called from within <a class="el" href="namespaceLua.html">Lua</a>. </p>
<pre class="fragment">int sum_numbers(int x, int y){
  return x+y;
}

Lua::LuaState L;
L.SetGlobal("sum_numbers", sum_numbers);
</pre><p>This works for any c-style function pointer or std::function.</p>
<h2>Classes </h2>
<p>To register a class, use LuaState::MakeClass(). Consider the following class. </p>
<pre class="fragment">class Example{
public:
  Example();
  Example(int x);

  int GetX();
  void SetX(int x);

private:
  int x;
};
</pre><p>To register it for use in <a class="el" href="namespaceLua.html">Lua</a>, one would use the following code. </p>
<pre class="fragment">Lua::LuaState L;
L.MakeClass&lt;Example&gt;("Example")
  .AddConstructor&lt;&gt;("make_Example")
  .AddConstructor&lt;int&gt;("make_Example_int")
  .AddMethod("GetX", &amp;Example::GetX)
  .AddMethod("SetX", &amp;Example::SetX)
</pre><p>Only the constructors and methods that are registered are available for use in <a class="el" href="namespaceLua.html">Lua</a>. This allows, for example, a class that can be passed in to <a class="el" href="namespaceLua.html">Lua</a>, but cannot be constructed from within <a class="el" href="namespaceLua.html">Lua</a>.</p>
<h2><a class="el" href="namespaceLua.html">Lua</a> Tables </h2>
<p>Two types of tables are supported as parameters and return values, when calling functions across the C++/Lua boundary.</p>
<p>The first are tables with only numerical keys, and only a single value type. These can be converted to <code>std::vector&lt;T&gt;</code>. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("function return_table() return {'a','b','c'} end");
std::vector&lt;std::string&gt; output =
   L.Call&lt;std::vector&lt;std::string&gt; &gt;("return_table");
</pre><p>The second are tables with only string keys, and only a single value type. These can be converted to <code>std::map&lt;std::string, T&gt;</code>. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("function return_table() return {a=5, b=7, c=9} end");
std::map&lt;std::string, int&gt; output =
  L.Call&lt;std::map&lt;std::string, int&gt; &gt;("return_table");
</pre><h2><a class="el" href="namespaceLua.html">Lua</a> Coroutines </h2>
<p>A function can be started as a <a class="el" href="namespaceLua.html">Lua</a> coroutine, rather than running directly. The main advantage is that coroutines can be yielded, while a function call cannot. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadSafeLibs();
L.LoadString("function yields() print('First') coroutine.yield() print('Second') end");

auto coroutine = L.NewCoroutine();
coroutine.LoadFunc("yields");
coroutine.Resume(); // Prints 'First'
coroutine.Resume(); // Prints 'Second'
</pre><p>In addition, coroutines can have limits placed on the number of <a class="el" href="namespaceLua.html">Lua</a> instructions that can be run. This prevents user scripts from suspending the program if they infinite loop. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadString("function infinite_loop() while true do end");

auto coroutine = L.NewCoroutine();
coroutine.LoadFunc("infinite_loop");
coroutine.SetMaxInstruction(10000);
coroutine.Resume(); // throws a LuaRuntimeTooLong.
</pre><p>Any arguments passed to <code>LuaCoroutine::Resume()</code> are given as the return values of <code>coroutine.yield()</code>. Similarly, any returns requested from <code>LuaCoroutine::Resume()</code> will give the value passed into <code>coroutine.yield()</code>, or the value of the <code>return</code> statement if the function finishes. The <code>IsFinished()</code> method can be used to determine whether a coroutine is completed, or has just yielded. </p>
<pre class="fragment">Lua::LuaState L;
L.LoadSafeLibs();
L.LoadString("functions yields_return(x) y = coroutine.yield(x) return y end");

auto coroutine = L.NewCoroutine();
coroutine.LoadFunc("yields_return");
auto return1 = coroutine.Resume&lt;int&gt;(5);
assert(!coroutine.IsFinished());
auto return2 = coroutine.Resume&lt;std::string&gt;("hello");
assert(coroutine.IsFinished()); </pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 31 2015 07:44:04 for lua-bindings by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
